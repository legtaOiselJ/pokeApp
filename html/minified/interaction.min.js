class PKMN{constructor(e=!0){this.HasAttacked=!1,this.animation_classes={enter:e?"slide-in-blurred-right":"slide-in-blurred-left",exit:"slide-out-bck-center",attack:"bounce-top",no_attack:"jello-horizontal",hit:"wobble-hor-bottom"},this.isAWildPokemon=e,this.isPokemonFainted=!1,this.pokemonDatas={pokeapi:{db:"https://pokeapi.co/api/v2",datas:null,specie:null},tyradex:{db:"https://tyradex.vercel.app/api/v1",datas:null}},this.stats={},this.moves=[],this.specials_moves=["Eau","Plante","Feu","Glace","Electrique","Psy","Dragon","Ténèbres"],this.docElements={},this.attributeElements()}attributeElements(){this.docElements={mainContainer:document.getElementById(this.isAWildPokemon?"wildMainContainer":"playerMainContainer"),name:document.getElementById(this.isAWildPokemon?"wildName":"playerName"),healthbar:{doc:document.getElementById(this.isAWildPokemon?"wildHP":"playerHP"),class:"p100"},pokemon:{container:document.getElementById(this.isAWildPokemon?"wildPkmn":"playerPkmn"),crie:document.getElementById(this.isAWildPokemon?"wildCrie":"playerCrie"),hit:document.getElementById(this.isAWildPokemon?"wildFX":"playerFX"),sprite:document.getElementById(this.isAWildPokemon?"wildSprite":"playerSprite")},moves:{name:document.getElementById("MoveName"),resistance:document.getElementById("MoveEfficacity")},panels:{beforeMove:document.getElementById("beforeMove"),afterMove:document.getElementById("afterMove")}}}attributesStats(e,A){const{isAWildPokemon:t,docElements:n,stats:s}=this;return new Promise(((o,i)=>{try{s.length<=0&&o(!1),this.docElements.pokemon.hit.src=window.FX;let i=parseInt(e[1]);if(s.level=parseInt(e[0]),s.index=i,s.name=e[2],!t){document.getElementById("pkmnCmd").innerHTML=`Que doit faire <b>${s.name}</b> ?`}s.types={type_1:e[3],type_2:e[4]},s.resistances=this.get_resistances(e[6],e[7]),s.health={active:parseInt(e[5]),full:parseInt(e[5]),level:100},s.attack={base:parseInt(e[6]),spe:parseInt(e[7])},s.defense={base:parseInt(e[8]),spe:parseInt(e[9])},s.speed=e[10];let a=window.mediasURL[i];n.pokemon.sprite.src=t?a.front:a.back,n.pokemon.crie.src=a.crie,s.experience=s.level*parseInt(e[11]),t||(A>0&&(s.experience=A),this.get_pokemon_details()),o(!0)}catch(e){console.log("failed to associate stats"),console.log(e),i(!1)}}))}get_pokemon_details(){const{stats:e,pokemonDatas:A}=this;fetch(`${A.pokeapi.db}/pokemon/${e.index}`).then((e=>e.json())).then((e=>{A.pokeapi.datas=e,this.get_specie_details()}))}get_specie_details(){const{pokemonDatas:e,stats:A}=this;fetch(`${e.pokeapi.db}/pokemon-species/${A.index}`).then((e=>e.json())).then((t=>{e.pokeapi.specie=t,A.growthRate=t.growth_rate.name,this.get_tyradex_details()}))}get_resistances(){const{stats:e}=this,A={Acier:{Acier:.5,Combat:2,Dragon:.5,Eau:1,Electrique:1,"Fée":.5,Feu:2,Glace:.5,Insecte:.5,Normal:.5,Plante:.5,Poison:0,Psy:.5,Roche:.5,Sol:2,Spectre:1,"Ténèbres":1,Vol:.5},Combat:{Acier:1,Combat:1,Dragon:1,Eau:1,Electrique:1,"Fée":2,Feu:1,Glace:1,Insecte:.5,Normal:1,Plante:1,Poison:1,Psy:2,Roche:.5,Sol:1,Spectre:1,"Ténèbres":.5,Vol:2},Dragon:{Acier:1,Combat:1,Dragon:2,Eau:.5,Electrique:.5,"Fée":2,Feu:.5,Glace:2,Insecte:.5,Normal:1,Plante:.5,Poison:1,Psy:1,Roche:1,Sol:1,Spectre:1,"Ténèbres":1,Vol:1},Eau:{Acier:.5,Combat:1,Dragon:1,Eau:.5,Electrique:2,"Fée":1,Feu:.5,Glace:.5,Insecte:1,Normal:1,Plante:2,Poison:1,Psy:1,Roche:1,Sol:1,Spectre:1,"Ténèbres":1,Vol:1},Electrique:{Acier:.5,Combat:1,Dragon:1,Eau:1,Electrique:.5,"Fée":1,Feu:1,Glace:1,Insecte:1,Normal:1,Plante:1,Poison:1,Psy:1,Roche:1,Sol:2,Spectre:1,"Ténèbres":1,Vol:.5},"Fée":{Acier:2,Combat:.5,Dragon:0,Eau:1,Electrique:1,"Fée":1,Feu:1,Glace:1,Insecte:.5,Normal:1,Plante:1,Poison:2,Psy:1,Roche:1,Sol:1,Spectre:1,"Ténèbres":.5,Vol:1},Feu:{Acier:.5,Combat:1,Dragon:1,Eau:2,Electrique:1,"Fée":.5,Feu:.5,Glace:.5,Insecte:.5,Normal:1,Plante:.5,Poison:1,Psy:1,Roche:2,Sol:2,Spectre:1,"Ténèbres":1,Vol:1},Glace:{Acier:2,Combat:2,Dragon:1,Eau:1,Electrique:1,"Fée":1,Feu:2,Glace:.5,Insecte:1,Normal:1,Plante:1,Poison:1,Psy:1,Roche:2,Sol:1,Spectre:1,"Ténèbres":1,Vol:1},Insecte:{Acier:1,Combat:.5,Dragon:1,Eau:1,Electrique:1,"Fée":1,Feu:2,Glace:1,Insecte:1,Normal:1,Plante:.5,Poison:1,Psy:1,Roche:2,Sol:.5,Spectre:1,"Ténèbres":1,Vol:2},Normal:{Acier:1,Combat:2,Dragon:1,Eau:1,Electrique:1,"Fée":1,Feu:1,Glace:1,Insecte:1,Normal:1,Plante:1,Poison:1,Psy:1,Roche:1,Sol:1,Spectre:0,"Ténèbres":1,Vol:2},Plante:{Acier:1,Combat:1,Dragon:1,Eau:.5,Electrique:.5,"Fée":1,Feu:2,Glace:2,Insecte:2,Normal:1,Plante:.5,Poison:2,Psy:1,Roche:1,Sol:.5,Spectre:1,"Ténèbres":1,Vol:2},Poison:{Acier:1,Combat:.5,Dragon:1,Eau:1,Electrique:1,"Fée":.5,Feu:1,Glace:1,Insecte:.5,Normal:1,Plante:.5,Poison:.5,Psy:2,Roche:1,Sol:2,Spectre:1,"Ténèbres":1,Vol:1},Psy:{Acier:1,Combat:.5,Dragon:1,Eau:1,Electrique:1,"Fée":1,Feu:1,Glace:1,Insecte:2,Normal:1,Plante:1,Poison:1,Psy:.5,Roche:1,Sol:1,Spectre:2,"Ténèbres":2,Vol:1},Roche:{Acier:2,Combat:2,Dragon:1,Eau:2,Electrique:1,"Fée":1,Feu:.5,Glace:1,Insecte:1,Normal:.5,Plante:2,Poison:.5,Psy:1,Roche:1,Sol:2,Spectre:1,"Ténèbres":1,Vol:.5},Sol:{Acier:1,Combat:1,Dragon:1,Eau:2,Electrique:0,"Fée":1,Feu:1,Glace:2,Insecte:1,Normal:1,Plante:2,Poison:.5,Psy:1,Roche:.5,Sol:1,Spectre:1,"Ténèbres":1,Vol:1},Spectre:{Acier:1,Combat:0,Dragon:1,Eau:1,Electrique:1,"Fée":1,Feu:1,Glace:1,Insecte:.5,Normal:0,Plante:1,Poison:.5,Psy:1,Roche:1,Sol:1,Spectre:2,"Ténèbres":2,Vol:1},"Ténèbres":{Acier:1,Combat:2,Dragon:1,Eau:1,Electrique:1,"Fée":2,Feu:1,Glace:1,Insecte:2,Normal:1,Plante:1,Poison:1,Psy:0,Roche:1,Sol:1,Spectre:.5,"Ténèbres":.5,Vol:1},Vol:{Acier:1,Combat:.5,Dragon:1,Eau:1,Electrique:2,"Fée":1,Feu:1,Glace:2,Insecte:.5,Normal:1,Plante:1,Poison:1,Psy:1,Roche:2,Sol:0,Spectre:1,"Ténèbres":1,Vol:1}};try{return[A[`${e.types.type_1}`],A[`${e.types.type_2}`]]}catch(e){return console.log(`an error occured while affecting efficacity : ${e}`),[]}}get_tyradex_details(){const{pokemonDatas:e,stats:A}=this;A.evolution={level:101,index:A.index},fetch(`${e.tyradex.db}/pokemon/${A.index}`).then((e=>e.json())).then((t=>{e.tyradex.datas=t;let n=t.evolution.next;null!=n&&(A.evolution.level=parseInt(n[0].condition.match(/\d+/)[0]),A.evolution.index=n[0].pokedex_id)}))}getTotalXPForLevel(e,A){switch(A){case"fast":return Math.floor(.8*Math.pow(e,3));case"medium-fast":return Math.pow(e,3);case"medium-slow":return Math.floor(1.2*Math.pow(e,3)-15*Math.pow(e,2)+100*e-140);default:return Math.floor(5/4*Math.pow(e,3))}}toNextLevel(e){const{stats:A,docElements:t}=this,n=this.getTotalXPForLevel(A.level,A.growthRate),s=this.getTotalXPForLevel(A.level+1,A.growthRate)-n;let o=A.experience+e,i=A.index,a=A.level;o>=s&&(a+=1,A.evolution.level<=a&&(i=A.evolution.index),o=s-o),window.AI2Message.index=i,window.AI2Message.level=a,window.AI2Message.xp=o}get_experience_gain(){const{isAWildPokemon:e,stats:A}=this;let t=e?1:1.25;return Math.floor(A.experience/7*t)}attributesMoves(e){const{moves:A}=this;e.length<=0||e.forEach((e=>{let t={power:parseInt(e[0]),type:e[1],name:e[2],definition:e[3]};A.push(t)}))}get_move_resistance(e){const{stats:A}=this;return(A.resistances[0][`${e}`]??1)*(A.resistances[1][`${e}`]??1)}get_speed(){return this.stats.speed}isASpecialMove(e){const{specials_moves:A}=this;let t=!1;return A.every((A=>e.type!=A||(t=!0,!1))),t}set_parameters(e,A,t=0){return new Promise((async(n,s)=>{this.attributesStats(e,t).then((e=>{this.attributesMoves(A),n(!0)}))}))}crie(){const{docElements:e}=this;try{e.pokemon.crie.play()}catch(e){console.log(`an error while crie playing ${e}`)}}async run_encounter(){const{isAWildPokemon:e,animation_classes:A,docElements:t,stats:n}=this;return new Promise((async(e,s)=>{try{this.wait_for_ms(300).then((async()=>{t.mainContainer.style.visibility="",this.isPokemonFainted&&e(!1),t.name.innerHTML=`${n.name}  Niv.${n.level}`,t.healthbar.doc.classList.contains(t.healthbar.class)&&t.healthbar.doc.classList.remove(t.healthbar.class),t.healthbar.class="p100",t.healthbar.doc.classList.add(t.healthbar.class),t.pokemon.container.classList.add(A.enter),t.pokemon.container.style.visibility="",this.wait_for_ms(600).then((()=>{e(!0),this.crie(),t.pokemon.container.classList.remove(A.enter)}))}))}catch(e){console.log(e),s(!1)}}))}getRandomInt(e,A=0){const t=Math.ceil(A),n=Math.floor(e);return Math.floor(Math.random()*(n-t+1)+t)}async run_attack(e=-1){const{isAWildPokemon:A,animation_classes:t,docElements:n,stats:s,moves:o}=this;return new Promise((async(i,a)=>{try{this.isPokemonFainted&&i(!1);let a=A?window.BATTLERS.Player:window.BATTLERS.Wild,l=null;l=-1==e?o[this.getRandomInt(3)]:o[e],n.panels.beforeMove.style.display="none",n.panels.afterMove.style.display="";let r=this.isASpecialMove(l),c=r?s.attack.spe:s.attack.base,d=r?a.stats.defense.spe:a.stats.defense.base,m=a.get_move_resistance(l.type),h=this.getRandomInt(100,85)/100,u=0,p="";l.power>0&&(u=Math.floor((2*s.level/5+2)*l.power*c/d/50+2)*m*h),u>0?(n.pokemon.container.classList.add(t.attack),m<=.5?p="Ce n'est pas très efficace.":m>=2&&(p="C'est super efficace !")):(n.pokemon.container.classList.add(t.no_attack),p="Cela n'a pas d'effets sur le pokémon adverse."),n.moves.name.innerHTML=`${s.name} lance ${l.name}`,n.moves.resistance.innerHTML=p,await this.wait_for_ms(1100),a.run_hit(u).then((e=>{u>0?n.pokemon.container.classList.remove(t.attack):n.pokemon.container.classList.remove(t.no_attack),i(!0)}))}catch(e){console.log(e),a(!1)}}))}async run_hit(e){const{animation_classes:A,docElements:t,stats:n}=this;return new Promise((async(s,o)=>{try{this.isPokemonFainted&&s(!1),e>0&&(window.audioElements.hit.play(),t.pokemon.hit.style.display="",t.pokemon.container.classList.add(A.hit));let o=n.health.active-e;n.health.active=o<0?0:o,n.health.level=Math.floor(n.health.active/n.health.full*100),t.healthbar.doc.classList.remove(t.healthbar.class),t.healthbar.class=`p${n.health.level}`,t.healthbar.doc.classList.add(t.healthbar.class),!this.isAWildPokemon&&n.health.level<=20&&window.audioElements.lowHealth.play(),await this.wait_for_ms(1500),e>0&&(t.pokemon.container.classList.remove(A.hit),t.pokemon.hit.style.display="none"),this.check_for_end_of_battle(),s(!0)}catch(e){console.log(e),o(!1)}}))}check_for_end_of_battle(){const{docElements:e,animation_classes:A,stats:t}=this;t.health.level<=0&&(this.isPokemonFainted=!0,e.pokemon.container.classList.add(A.exit),this.crie(),this.wait_for_ms(800).then((A=>{e.mainContainer.style.visibility="hidden",window.appEvents.endOfBattle.detail.exit=this.isAWildPokemon?"victoire":"défaite",window.dispatchEvent(window.appEvents.endOfBattle)})))}async wait_for_ms(e){return new Promise((A=>setTimeout(A,e)))}}class playerPKMN extends PKMN{constructor(e=[]){super(!1),this.movesElements=e}split_on_character(e,A){let t=e.substring(0,12);t=t.split(A);for(let e=0;e<t.length;e++)t[e].length>6&&(t[e]=t[e].substring(0,6)+".");return t.join(A)}controlMoveNameLength(e){if(e.includes("-"))return this.split_on_character(e,"-");if(e.includes(" "))return this.split_on_character(e," ");{let A=e;return e.length>6&&(A=e.substring(0,6)+"."),A}}set_moves_buttons(e,A,t){const{movesElements:n,moves:s}=this;this.set_parameters(e,A,t).then((e=>{n.length<=0||n.forEach((e=>{let A=parseInt(e.id);e.innerHTML=this.controlMoveNameLength(s[A].name),e.addEventListener("click",(e=>{window.dispatchEvent(window.appEvents.anyClick);let A=parseInt(e.target.id);this.move_selected(A)}))}))}))}move_selected(e){const{stats:A}=this;let t=A.speed,n=window.BATTLERS.Wild.stats.speed;this.wait_for_ms(500).then((A=>{this.isPokemonFainted?window.dispatchEvent(window.appEvents.endOfTurn):t<n?window.BATTLERS.Wild.run_attack().then((async A=>{await this.wait_for_ms(500),this.isPokemonFainted||this.run_attack(e).then((async e=>{await this.wait_for_ms(500),window.dispatchEvent(window.appEvents.endOfTurn)}))})):this.run_attack(e).then((async e=>{await this.wait_for_ms(250),window.BATTLERS.Wild.isPokemonFainted||window.BATTLERS.Wild.run_attack().then((async e=>{await this.wait_for_ms(500),window.dispatchEvent(window.appEvents.endOfTurn)}))}))}))}}export class JEU_POKEMON{constructor(){window.BATTLERS={Wild:null,Player:null},this.beforeMoveDiv=null,this.afterMoveDiv=null,this.endBattleDiv=null,this.expContainer=null,this.wildXP=null,this.set_battlers(),this.set_events(),this.set_medias(),this.get_and_set_docElements()}set_medias(){fetch("medias.json").then((e=>e.json())).then((e=>{window.mediasURL=e})).catch((e=>console.error(e)))}url_backgrounds(e,A,t){window.backgrounds={day:e,night:A,boss:t}}url_hit(e){window.FX="https://cdn.glitch.global/7e8b88c9-55ef-4f25-b07d-e8c3bccc676f/bigHit.gif?v=1709155492849"}url_songs(e,A){window.SONGS={wild:e,boss:A}}set_battlers(){window.BATTLERS.Wild=new PKMN,window.BATTLERS.Player=new playerPKMN([document.getElementById("0"),document.getElementById("1"),document.getElementById("2"),document.getElementById("3")]),window.AI2Message={cmd:"",index:1,level:101,xp:0}}set_events(){window.appEvents={anyClick:new CustomEvent("anyClick",{detail:{}}),endOfTurn:new CustomEvent("endOfTurn",{detail:{}}),endOfBattle:new CustomEvent("endOfBattle",{detail:{exit:"fuite"}})},document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".framed").forEach((e=>{e.style.borderImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAMAAAAPdrEwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAABgQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMM8PuMAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGHRFWHRTb2Z0d2FyZQBwYWludC5uZXQgNC4xLjVkR1hSAAAA5UlEQVRoQ+3MQQrDMBBD0fb+h06N/2A+MTHdTtBbKRpHn0u+UtUf6oepqinTQ1VT62kfyNgbuHcGTaYXmqbT9XXEU6vDUaZvWk/XHxtfn/KOa6YXrk2n/UGGG7K5J8NNpgc3rafBAW7I5p4MGmR6oMFrpvf8xG+ckemV0XraB+czv3RGpldG62n47PzEb5yR6ZXxmmm4IZt7MmiQ6YEGrad9IGNv4N4ZNJleaJpO19cRT60OR5m+aT1df2x8fco7rpleuDad9gcZbsjmngw3mR7ctJ4GB1T1h/phqmrK9FDV1HH6un4ss9jsFZtJkQAAAABJRU5ErkJggg==') 42 round"}));document.querySelectorAll(".progress-bar").forEach((e=>{e.style.borderImageSource="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAECAYAAABLLYUHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjEuNWRHWFIAAAAfSURBVBhXY/j//z+DhIAAkPrPAGeAaFQOjPH//38GAJDaGTlUem+VAAAAAElFTkSuQmCC')"}))}))}get_and_set_docElements(){const{docElements:e}=this;window.audioElements={music:document.getElementById("audio_combat"),victory:document.getElementById("audio_victoire"),escape:document.getElementById("audio_fuite"),hit:document.getElementById("audio_coup"),level:document.getElementById("audio_niveau"),lowHealth:document.getElementById("audio_critique"),button:document.getElementById("audio_bouton")},window.addEventListener("anyClick",(e=>{window.audioElements.button.play()})),this.divStart=document.getElementById("onStart"),this.beforeMoveDiv=document.getElementById("beforeMove"),this.afterMoveDiv=document.getElementById("afterMove"),this.endBattleDiv=document.getElementById("onEnd"),this.expContainer=document.getElementById("ExpDesc"),this.wildXP=document.getElementById("expWild"),this.ai2Button=document.getElementById("AI2Exit"),window.addEventListener("OnAttackSelected",(e=>{this.beforeMoveDiv.style.display="none",this.endBattleDiv.style.display="none",this.afterMoveDiv.style.display=""})),window.addEventListener("endOfTurn",(e=>{this.afterMoveDiv.style.display="none",this.endBattleDiv.style.display="none",window.BATTLERS.Player.isPokemonFainted||(this.beforeMoveDiv.style.display=""),this.enable_move_panel(!1)})),window.addEventListener("endOfBattle",(e=>{window.audioElements.music.pause(),this.divStart.style.display="none",this.ai2Button.style.visibility="hidden",this.afterMoveDiv.style.display="none",this.beforeMoveDiv.style.display="none",this.endBattleDiv.style.display="",this.expContainer=document.getElementById("ExpDesc"),this.overContainer=document.getElementById("GameOverDesc");let A=e.detail.exit;window.AI2Message={cmd:A,index:window.BATTLERS.Player.stats.index,level:window.BATTLERS.Player.stats.level,xp:window.BATTLERS.Player.stats.experience},"victoire"==A?this.on_victory():"défaite"==A?this.on_game_over():"fuite"==A&&this.on_escape(),this.ai2Button.onclick=e=>{window.dispatchEvent(window.appEvents.anyClick),this.messageToAI2(JSON.stringify(window.AI2Message))}}))}on_victory(){window.audioElements.victory.play(),this.expContainer.style.display="",this.wildXP.innerHTML=`${window.BATTLERS.Wild.stats.name} est K.O`;let e=window.BATTLERS.Wild.get_experience_gain(),A=document.getElementById("expPlayer");A.innerHTML=`${window.BATTLERS.Player.stats.name} remporte ${e} points d'expérience.`,window.BATTLERS.Player.wait_for_ms(2e3).then((t=>{window.BATTLERS.Player.toNextLevel(e),window.AI2Message.level>window.BATTLERS.Player.stats.level?(A.innerHTML=`${window.BATTLERS.Player.stats.name} monte au niveau: ${window.AI2Message.level}.`,window.BATTLERS.Player.wait_for_ms(2e3).then((e=>{this.ai2Button.style.visibility=""}))):this.ai2Button.style.visibility=""}))}on_game_over(){document.getElementById("overPlayer").innerHTML=`${window.BATTLERS.Player.stats.name} est K.O`,this.overContainer.style.display="",window.audioElements.lowHealth.pause(),document.getElementById("expPlayer").innerHTML=`${window.BATTLERS.Player.stats.name} est K.O !`,this.ai2Button.style.visibility=""}on_escape(){window.audioElements.escape.play(),document.getElementById("EscapeDesc").style.display="",this.ai2Button.style.visibility=""}ClampValue(e,A,t){return Math.min(Math.max(e,A),t)}Test(e="jour",A=143,t=40){let n=document.getElementById("startButton"),s="newbie";"jour"!=e&&(s="nuit"==e?"dark newbie":"great newbie"),n.innerHTML=s,n.classList.add("vibrate-1");let o=[11,this.ClampValue(A,1,151),"Tajiri","Normal","Normal",68,38,26,23,36,15,189],i=[11,"boss"==e?0:this.ClampValue(t,1,151),"Sugimori","Poison","Vol",33,17,13,14,15,19,49];this.start(e,o,[[10,"Normal","U R","Le lanceur bloque la route de l’ennemi pour empêcher sa fuite."],[25,"Eau","Awesome","Fonction de test 1"],[35,"Feu","Superb","Fonction de test 2"],[30,"Plante","Amazing","Fonction de test 3"]],189,i,[[10,"Normal","secondeBeam","Fonction de test 1"],[15,"Vol","oiselStorm","Fonction de test 2"],[20,"Normal","legtaSlash","Fonction de test 3"],[25,"Psy","sntDoom","Fonction de test 4"]])}AI2start(){let e=window.AppInventor.getWebViewString(),A=JSON.parse(e),t=A.mode,n=JSON.parse(A.player.stats),s=JSON.parse(A.player.moves),o=parseInt(A.player.xp),i=JSON.parse(A.wild.stats),a=JSON.parse(A.wild.moves);this.start(t,n,s,o,i,a)}start(e,A,t,n,s,o){const i=document.querySelector(".combatPanel");"boss"==e?(window.bossMode=!0,i.style.backgroundImage=`url(${window.backgrounds.boss})`,window.audioElements.music.src=window.SONGS.boss):(window.bossMode=!1,i.style.backgroundImage="jour"==e?`url(${window.backgrounds.day})`:`url(${window.backgrounds.night})`,window.audioElements.music.src=window.SONGS.wild),window.BATTLERS.Player.set_moves_buttons(A,t,n),window.BATTLERS.Wild.set_parameters(s,o).then((e=>{let A=document.getElementById("startButton");A.addEventListener("click",(e=>{this.run_game()})),A.style.visibility=""}))}run_game(){document.getElementById("vueDemarrage").style.display="none",window.audioElements.music.loop=!0,window.audioElements.music.play();document.getElementById("vuePrincipale").style.visibility="",document.getElementById("PkmnEncounter").innerHTML=`Vous rencontrez un <b>${window.BATTLERS.Wild.stats.name}</b> !`;let e=document.getElementById("AttButton"),A=document.getElementById("EscButton");e.onclick=e=>{window.dispatchEvent(window.appEvents.anyClick),this.enable_move_panel(!0)},A.onclick=e=>{window.dispatchEvent(window.appEvents.anyClick),this.divStart.style.display="none",window.dispatchEvent(window.appEvents.endOfBattle)},window.BATTLERS.Wild.run_encounter().then((e=>{this.divStart.style.display="",window.BATTLERS.Player.run_encounter()}))}enable_move_panel(e){this.divStart.style.display=e?"none":"",this.beforeMoveDiv.style.display=e?"":"none"}messageToAI2(e){try{window.AppInventor.setWebViewString(e)}catch(e){console.log(e)}}}
